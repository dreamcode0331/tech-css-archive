* {
  box-sizing: border-box;
}

body {
  margin: 0;
  min-height: 80vh;
  display: flex;
  justify-content: center;
  align-items: center;
  font-family: system-ui, sans-serif;
}

/* 1. 기본 Select 스타일링 */
select {
  padding: 8px 16px;
  border-radius: 8px;
  min-width: 220px;
  border: 2px solid transparent;
  background: #f1f1f1;
  /* field-sizing: 요소 내 콘텐츠 양에 따라 너비가 자동으로 조절됨 */
  field-sizing: content;
}

/* 2. 커스텀 모드 활성화 (핵심) */
select,
select::picker(select) {
  field-sizing: content;
  /* appearance: base-select
     브라우저 기본 UI를 제거하고, 개발자가 마크업한 구조로 커스텀 렌더링을 허용함 */
  appearance: base-select;
}

/* 3. 드롭다운 팝업(Picker) 스타일링 */
/* ::picker(select): 클릭 시 나타나는 옵션 목록 레이어 자체를 선택 */
select::picker(select) {
  margin-block: 1rem;
  border-radius: 12px;
  border: 1px solid #e0e0e0;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.18);
}

/* 기본 상태 */
select::picker-icon {
  transition: transform 0.3s ease; /* 부드러운 회전 효과 */
}

/* 셀렉트 박스가 열렸을 때 아이콘 회전 */
select:open::picker-icon {
  transform: rotate(180deg);
}

select:hover {
  border: 2px solid #000;
}

/* 4. 선택된 콘텐츠 표시 영역 */
/* <selectedcontent>: 사용자가 선택한 옵션의 HTML 구조를 그대로 버튼 안에 복사해서 보여주는 특수 태그 */
selectedcontent {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
}


/* 5. 옵션 스타일 및 애니메이션 */
option {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding-block: 8px;
  padding-inline: 12px 16px;
  transition:
    opacity 0.25s ease,
    translate 0.5s ease;
  
  /* sibling-index(): 형제 중 순번(1, 2, 3...)을 가져와 순차적으로 나타나는(Staggered) 효과 구현 */
  transition-delay: calc(0.2s * (sibling-index() - 2)); 

  /* @starting-style: 요소가 DOM에 나타나기 시작하는 '최초 상태'를 정의 (등장 애니메이션용) */
  @starting-style {
    opacity: 0;
    translate: 30px 0;
  }
}

/* 브라우저 기본 체크마크 숨김 */
option::checkmark {
  display: none;
}

/* 첫 번째 옵션(Placeholder 역할)은 애니메이션 제외 */
option:first-of-type {
  transition: none;

  @starting-style {
    opacity: 0;
    translate: 0 0;
  }
}

/* 선택이 완료된 상태에서는 애니메이션 중단 */
select:has(option:checked:not(:disabled)) option {
  transition: none;
}

/* 6. 데이터 속성 기반 동적 컬러링 */
option:hover,
option:focus,
option:checked {
  /* color-mix: 두 가지 색상을 섞어줌 (데이터 속성 컬러 + 투명도) */
  background-color: color-mix(
    in srgb,
    /* attr(data-name type): HTML의 data 속성값을 실제 CSS 색상(color) 타입으로 읽어옴 */
    attr(data-bg-color type(<color>)) 90%, 
    transparent
  );
}

/* 선택된 옵션에 커스텀 체크 표시 */
option:not(:disabled):checked:after {
  content: "✓";
  margin-left: auto;
}

/* 7. 기능 제어 및 브라우저 지원 안내 */
.toggle {
  position: absolute;
  top: 1rem;
  right: 1rem;
  width: max-content;
  padding: 10px 12px;
  border: 1px solid;
  border-radius: 8px;
  gap: 4px;
  align-items: center;  
  box-shadow: 0 5px 30px rgba(0, 0, 0, 0.18);
  display: none;
  
  /* @supports: 브라우저가 base-select를 지원할 때만 노출 */
  @supports(appearance: base-select) {
    display: flex;
  }
}

/* 토글 체크 시 다시 기본(auto) UI로 복구해보기 위한 로직 */
body:has(#toggle-select:checked) select {
  appearance: auto;
}

/* 지원하지 않는 브라우저용 알림 */
.support-note {
  padding: 1rem;
  line-height: 1.5;
  background: lightyellow;
  border: 1px solid gold;
  border-radius: 0.5rem;
  color: black;
  position: fixed;
  top: 1rem;
  left: 1rem;
  right: 1rem;
  width: fit-content;
  margin-inline: auto;
  
  /* base-select를 지원하는 브라우저에서는 이 노트를 숨김 */
  @supports(appearance: base-select) {
    display: none;
  }
}

footer {
  position: absolute;
  width: 100%;
  left: 0;
  bottom: 0;
  text-align: center;
  padding: 16px;
  background-color: #eaeaea90;
  display: flex;
  justify-content: center;
}

footer p {
  color: #221133;
  margin: 0;
}